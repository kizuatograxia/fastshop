import{at as Qe,aa as e,ad as h,ai as g,au as Ye,ag as oe,av as A,aw as Y,ax as le,a9 as i,ay as te,ap as Be,az as Ke,aA as Je,ae as se,aB as Ze,aC as Z,aD as Te,aE as X,aF as ee,aG as xe,aH as Xe,aI as fe,aJ as et,aK as Oe,as as tt,aL as nt,aM as Me,aN as it,aO as at,aP as we,aQ as rt,aR as lt}from"./index-YbAxbseJ.js";import ot from"./AllWalletsUI-BrFKfh7x.js";import{hasStoredPasskey as st}from"./passkeys-d7T7eALl.js";function ct(){return Qe("useAddConnectedWallet").addConnectedWallet}function Se(t){return e.jsxs(h,{animate:"fadein",children:[e.jsx(g,{y:"xxl"}),e.jsx(h,{center:"x",flex:"row",children:e.jsx(Ye,{size:oe["3xl"]})}),e.jsx(g,{y:"lg"}),e.jsx(A,{center:!0,color:"primaryText",size:"md",children:t.title}),e.jsx(g,{y:"xl"}),e.jsx(g,{y:"xxl"}),e.jsx(Y,{fullWidth:!0,onClick:t.onTryAgain,variant:"accent",children:"Try Again"})]})}function ke(t){return e.jsxs(h,{animate:"fadein",children:[e.jsx(g,{y:"xxl"}),e.jsxs(h,{center:"x",flex:"row",style:{position:"relative"},children:[e.jsx(le,{color:"accentText",size:"4xl"}),e.jsx(h,{color:"accentText",style:{left:"50%",position:"absolute",top:"50%",transform:"translate(-50%, -50%)"},children:t.icon})]}),e.jsx(g,{y:"xl"}),e.jsx(A,{center:!0,color:"primaryText",size:"lg",children:t.title}),e.jsx(g,{y:"md"}),e.jsx(A,{center:!0,multiline:!0,children:t.subtitle}),e.jsx(g,{y:"xxl"}),e.jsx(g,{y:"xxl"})]})}function zt(t){var k;const{wallet:n,done:a}=t,o=ct(),r=i.useRef(void 0),[u,x]=i.useState("selecting"),[p,m]=i.useState(),[S,d]=i.useState(!1),b=te(n)?{id:n.id,partnerId:(k=n.getConfig())==null?void 0:k.partnerId}:void 0,v=()=>{x("selecting"),r.current=void 0,t.onBack()};async function w(y){x("loading"),m(void 0),r.current=y;try{t.isLinking?await Z({chain:t.chain||n.getChain()||Te(1),client:t.client,ecosystem:b,strategy:"wallet",wallet:y}):await n.connect({chain:t.chain||y.getChain()||Te(1),client:t.client,strategy:"wallet",wallet:y}),o(y),a()}catch(f){m(f instanceof Error?f.message:"Unknown error"),x("error")}}return r.current?e.jsxs(h,{animate:"fadein",flex:"column",fullHeight:!0,children:[e.jsx(h,{p:"lg",children:e.jsx(se,{onBack:v,title:t.isLinking?t.inAppLocale.linkWallet:t.inAppLocale.signInWithWallet})}),e.jsx(h,{center:"y",expand:!0,flex:"column",px:t.size==="wide"?"xxl":"lg",children:e.jsx("div",{children:u==="error"?e.jsxs(e.Fragment,{children:[e.jsx(Se,{onTryAgain:()=>{if(!r.current)throw new Error("Failed to connect to unknown wallet");w(r.current)},title:p||"Failed to Login"}),e.jsx(g,{y:"lg"})]}):e.jsx(ke,{icon:e.jsx(Ze,{client:t.client,id:r.current.id??"",size:oe.xl}),subtitle:"A pop-up prompt will appear to sign-in and verify your wallet",title:"Sign in with your wallet"})})})]}):S?e.jsx(i.Suspense,{fallback:e.jsx(Be,{}),children:e.jsx(ot,{client:t.client,connectLocale:t.locale,disableSelectionDataReset:!0,onBack:()=>d(!1),onSelect:async y=>{w(y),d(!1)},recommendedWallets:void 0,size:t.size})}):e.jsx(Ke,{chain:n.getChain(),chains:[],client:t.client,connectLocale:t.locale,disableSelectionDataReset:!0,done:()=>{},goBack:v,hideHeader:!1,meta:t.meta||{},modalHeader:{onBack:v,title:t.isLinking?t.inAppLocale.linkWallet:t.inAppLocale.signInWithWallet},onShowAll:()=>{d(!0)},recommendedWallets:void 0,selectWallet:async y=>{w(y)},setModalVisibility:()=>{},showAllWallets:!0,size:t.size,title:t.locale.connectAWallet,walletConnect:t.walletConnect,walletIdsToHide:["inApp"],wallets:Je()})}function Dt(t){var v;const n=t.locale,a=n.socialLoginScreen,[o,r]=i.useState(void 0),{done:u,wallet:x}=t,[p,m]=i.useState("connecting"),S=async()=>{var k,y;const w={client:t.client,ecosystem:te(x)?{id:x.id,partnerId:(k=x.getConfig())==null?void 0:k.partnerId}:void 0,strategy:"guest"};try{await x.connect(w),await X("guest",ee),m("connected"),u()}catch(f){m("error"),f instanceof Error&&((y=f==null?void 0:f.message)!=null&&y.includes("PAYMENT_METHOD_REQUIRED"))&&r(n.maxAccountsExceeded),console.error("Error generating guest account",f)}},d=(v=t.state)==null?void 0:v.guestLogin,b=i.useRef(!1);return i.useEffect(()=>{b.current||d&&(b.current=!0,m("connecting"),d.connectionPromise.then(()=>{u(),m("connected")}).catch(w=>{r(w.message),m("error")}))},[u,d]),e.jsx(h,{animate:"fadein",flex:"column",fullHeight:!0,className:"tw-guest-login-screen",children:e.jsxs(h,{expand:!0,flex:"column",p:"lg",style:{paddingBottom:0},children:[t.goBack&&e.jsx(se,{onBack:t.goBack,title:a.title}),t.size==="compact"?e.jsx(g,{y:"xl"}):null,e.jsxs(h,{center:"both",expand:!0,flex:"column",style:{minHeight:"250px",textAlign:"center"},children:[p!=="error"&&e.jsxs(h,{animate:"fadein",children:[e.jsx(A,{center:!0,color:"primaryText",multiline:!0,style:{maxWidth:"250px"},children:"Generating your guest account"}),e.jsx(g,{y:"xl"}),e.jsx(h,{center:"x",flex:"row",children:e.jsx(le,{color:"accentText",size:"lg"})}),e.jsx(g,{y:"xxl"})]}),p==="error"&&e.jsxs(h,{animate:"fadein",children:[o?e.jsx(A,{center:!0,color:"danger",children:o}):e.jsx(A,{color:"danger",children:a.failed}),e.jsx(g,{y:"lg"}),e.jsx(Y,{onClick:S,variant:"primary",children:a.retry}),e.jsx(g,{y:"xxl"})]})]})]})})}const ve=xe({animation:`${Xe} 0.15s ease-in`});var ut=Object.defineProperty,dt=Object.defineProperties,gt=Object.getOwnPropertyDescriptors,ge=Object.getOwnPropertySymbols,ze=Object.prototype.hasOwnProperty,De=Object.prototype.propertyIsEnumerable,Re=(t,n,a)=>n in t?ut(t,n,{enumerable:!0,configurable:!0,writable:!0,value:a}):t[n]=a,xt=(t,n)=>{for(var a in n||(n={}))ze.call(n,a)&&Re(t,a,n[a]);if(ge)for(var a of ge(n))De.call(n,a)&&Re(t,a,n[a]);return t},ft=(t,n)=>dt(t,gt(n)),ht=(t,n)=>{var a={};for(var o in t)ze.call(t,o)&&n.indexOf(o)<0&&(a[o]=t[o]);if(t!=null&&ge)for(var o of ge(t))n.indexOf(o)<0&&De.call(t,o)&&(a[o]=t[o]);return a};function mt(t){let n=setTimeout(t,0),a=setTimeout(t,10),o=setTimeout(t,50);return[n,a,o]}function yt(t){let n=i.useRef();return i.useEffect(()=>{n.current=t}),n.current}var pt=18,Fe=40,jt=`${Fe}px`,vt=["[data-lastpass-icon-root]","com-1password-button","[data-dashlanecreated]",'[style$="2147483647 !important;"]'].join(",");function wt({containerRef:t,inputRef:n,pushPasswordManagerStrategy:a,isFocused:o}){let[r,u]=i.useState(!1),[x,p]=i.useState(!1),[m,S]=i.useState(!1),d=i.useMemo(()=>a==="none"?!1:(a==="increase-width"||a==="experimental-no-flickering")&&r&&x,[r,x,a]),b=i.useCallback(()=>{let v=t.current,w=n.current;if(!v||!w||m||a==="none")return;let k=v,y=k.getBoundingClientRect().left+k.offsetWidth,f=k.getBoundingClientRect().top+k.offsetHeight/2,j=y-pt,z=f;document.querySelectorAll(vt).length===0&&document.elementFromPoint(j,z)===v||(u(!0),S(!0))},[t,n,m,a]);return i.useEffect(()=>{let v=t.current;if(!v||a==="none")return;function w(){let y=window.innerWidth-v.getBoundingClientRect().right;p(y>=Fe)}w();let k=setInterval(w,1e3);return()=>{clearInterval(k)}},[t,a]),i.useEffect(()=>{let v=o||document.activeElement===n.current;if(a==="none"||!v)return;let w=setTimeout(b,0),k=setTimeout(b,2e3),y=setTimeout(b,5e3),f=setTimeout(()=>{S(!0)},6e3);return()=>{clearTimeout(w),clearTimeout(k),clearTimeout(y),clearTimeout(f)}},[n,o,a,b]),{hasPWMBadge:r,willPushPWMBadge:d,PWM_BADGE_SPACE_WIDTH:jt}}var St=i.createContext({}),_e=i.forwardRef((t,n)=>{var a=t,{value:o,onChange:r,maxLength:u,textAlign:x="left",pattern:p,placeholder:m,inputMode:S="numeric",onComplete:d,pushPasswordManagerStrategy:b="increase-width",pasteTransformer:v,containerClassName:w,noScriptCSSFallback:k=kt,render:y,children:f}=a,j=ht(a,["value","onChange","maxLength","textAlign","pattern","placeholder","inputMode","onComplete","pushPasswordManagerStrategy","pasteTransformer","containerClassName","noScriptCSSFallback","render","children"]),z,F,$,G,L;let[B,ce]=i.useState(typeof j.defaultValue=="string"?j.defaultValue:""),c=o??B,W=yt(c),I=i.useCallback(l=>{r==null||r(l),ce(l)},[r]),D=i.useMemo(()=>p?typeof p=="string"?new RegExp(p):p:null,[p]),C=i.useRef(null),he=i.useRef(null),me=i.useRef({value:c,onChange:I,isIOS:typeof window<"u"&&((F=(z=window==null?void 0:window.CSS)==null?void 0:z.supports)==null?void 0:F.call(z,"-webkit-touch-callout","none"))}),ue=i.useRef({prev:[($=C.current)==null?void 0:$.selectionStart,(G=C.current)==null?void 0:G.selectionEnd,(L=C.current)==null?void 0:L.selectionDirection]});i.useImperativeHandle(n,()=>C.current,[]),i.useEffect(()=>{let l=C.current,s=he.current;if(!l||!s)return;me.current.value!==l.value&&me.current.onChange(l.value),ue.current.prev=[l.selectionStart,l.selectionEnd,l.selectionDirection];function P(){if(document.activeElement!==l){ie(null),ae(null);return}let E=l.selectionStart,T=l.selectionEnd,de=l.selectionDirection,O=l.maxLength,V=l.value,_=ue.current.prev,H=-1,N=-1,q;if(V.length!==0&&E!==null&&T!==null){let Ue=E===T,Ve=E===V.length&&V.length<O;if(Ue&&!Ve){let Q=E;if(Q===0)H=0,N=1,q="forward";else if(Q===O)H=Q-1,N=Q,q="backward";else if(O>1&&V.length>1){let je=0;if(_[0]!==null&&_[1]!==null){q=Q<_[1]?"backward":"forward";let qe=_[0]===_[1]&&_[0]<O;q==="backward"&&!qe&&(je=-1)}H=je+Q,N=je+Q+1}}H!==-1&&N!==-1&&H!==N&&C.current.setSelectionRange(H,N,q)}let Pe=H!==-1?H:E,We=N!==-1?N:T,Ge=q??de;ie(Pe),ae(We),ue.current.prev=[Pe,We,Ge]}if(document.addEventListener("selectionchange",P,{capture:!0}),P(),document.activeElement===l&&ye(!0),!document.getElementById("input-otp-style")){let E=document.createElement("style");if(E.id="input-otp-style",document.head.appendChild(E),E.sheet){let T="background: transparent !important; color: transparent !important; border-color: transparent !important; opacity: 0 !important; box-shadow: none !important; -webkit-box-shadow: none !important; -webkit-text-fill-color: transparent !important;";re(E.sheet,"[data-input-otp]::selection { background: transparent !important; color: transparent !important; }"),re(E.sheet,`[data-input-otp]:autofill { ${T} }`),re(E.sheet,`[data-input-otp]:-webkit-autofill { ${T} }`),re(E.sheet,"@supports (-webkit-touch-callout: none) { [data-input-otp] { letter-spacing: -.6em !important; font-weight: 100 !important; font-stretch: ultra-condensed; font-optical-sizing: none !important; left: -1px !important; right: 1px !important; } }"),re(E.sheet,"[data-input-otp] + * { pointer-events: all !important; }")}}let M=()=>{s&&s.style.setProperty("--root-height",`${l.clientHeight}px`)};M();let R=new ResizeObserver(M);return R.observe(l),()=>{document.removeEventListener("selectionchange",P,{capture:!0}),R.disconnect()}},[]);let[be,Ee]=i.useState(!1),[ne,ye]=i.useState(!1),[U,ie]=i.useState(null),[K,ae]=i.useState(null);i.useEffect(()=>{mt(()=>{var l,s,P,M;(l=C.current)==null||l.dispatchEvent(new Event("input"));let R=(s=C.current)==null?void 0:s.selectionStart,E=(P=C.current)==null?void 0:P.selectionEnd,T=(M=C.current)==null?void 0:M.selectionDirection;R!==null&&E!==null&&(ie(R),ae(E),ue.current.prev=[R,E,T])})},[c,ne]),i.useEffect(()=>{W!==void 0&&c!==W&&W.length<u&&c.length===u&&(d==null||d(c))},[u,d,W,c]);let J=wt({containerRef:he,inputRef:C,pushPasswordManagerStrategy:b,isFocused:ne}),Ce=i.useCallback(l=>{let s=l.currentTarget.value.slice(0,u);if(s.length>0&&D&&!D.test(s)){l.preventDefault();return}typeof W=="string"&&s.length<W.length&&document.dispatchEvent(new Event("selectionchange")),I(s)},[u,I,W,D]),Ae=i.useCallback(()=>{var l;if(C.current){let s=Math.min(C.current.value.length,u-1),P=C.current.value.length;(l=C.current)==null||l.setSelectionRange(s,P),ie(s),ae(P)}ye(!0)},[u]),Le=i.useCallback(l=>{var s,P;let M=C.current;if(!v&&(!me.current.isIOS||!l.clipboardData||!M))return;let R=l.clipboardData.getData("text/plain"),E=v?v(R):R;l.preventDefault();let T=(s=C.current)==null?void 0:s.selectionStart,de=(P=C.current)==null?void 0:P.selectionEnd,O=(T!==de?c.slice(0,T)+E+c.slice(de):c.slice(0,T)+E+c.slice(T)).slice(0,u);if(O.length>0&&D&&!D.test(O))return;M.value=O,I(O);let V=Math.min(O.length,u-1),_=O.length;M.setSelectionRange(V,_),ie(V),ae(_)},[u,I,D,c]),He=i.useMemo(()=>({position:"relative",cursor:j.disabled?"default":"text",userSelect:"none",WebkitUserSelect:"none",pointerEvents:"none"}),[j.disabled]),Ie=i.useMemo(()=>({position:"absolute",inset:0,width:J.willPushPWMBadge?`calc(100% + ${J.PWM_BADGE_SPACE_WIDTH})`:"100%",clipPath:J.willPushPWMBadge?`inset(0 ${J.PWM_BADGE_SPACE_WIDTH} 0 0)`:void 0,height:"100%",display:"flex",textAlign:x,opacity:"1",color:"transparent",pointerEvents:"all",background:"transparent",caretColor:"transparent",border:"0 solid transparent",outline:"0 solid transparent",boxShadow:"none",lineHeight:"1",letterSpacing:"-.5em",fontSize:"var(--root-height)",fontFamily:"monospace",fontVariantNumeric:"tabular-nums"}),[J.PWM_BADGE_SPACE_WIDTH,J.willPushPWMBadge,x]),Ne=i.useMemo(()=>i.createElement("input",ft(xt({autoComplete:j.autoComplete||"one-time-code"},j),{"data-input-otp":!0,"data-input-otp-placeholder-shown":c.length===0||void 0,"data-input-otp-mss":U,"data-input-otp-mse":K,inputMode:S,pattern:D==null?void 0:D.source,"aria-placeholder":m,style:Ie,maxLength:u,value:c,ref:C,onPaste:l=>{var s;Le(l),(s=j.onPaste)==null||s.call(j,l)},onChange:Ce,onMouseOver:l=>{var s;Ee(!0),(s=j.onMouseOver)==null||s.call(j,l)},onMouseLeave:l=>{var s;Ee(!1),(s=j.onMouseLeave)==null||s.call(j,l)},onFocus:l=>{var s;Ae(),(s=j.onFocus)==null||s.call(j,l)},onBlur:l=>{var s;ye(!1),(s=j.onBlur)==null||s.call(j,l)}})),[Ce,Ae,Le,S,Ie,u,K,U,j,D==null?void 0:D.source,c]),pe=i.useMemo(()=>({slots:Array.from({length:u}).map((l,s)=>{var P;let M=ne&&U!==null&&K!==null&&(U===K&&s===U||s>=U&&s<K),R=c[s]!==void 0?c[s]:null,E=c[0]!==void 0?null:(P=m==null?void 0:m[s])!=null?P:null;return{char:R,placeholderChar:E,isActive:M,hasFakeCaret:M&&R===null}}),isFocused:ne,isHovering:!j.disabled&&be}),[ne,be,u,K,U,j.disabled,c]),$e=i.useMemo(()=>y?y(pe):i.createElement(St.Provider,{value:pe},f),[f,pe,y]);return i.createElement(i.Fragment,null,k!==null&&i.createElement("noscript",null,i.createElement("style",null,k)),i.createElement("div",{ref:he,"data-input-otp-container":!0,style:He,className:w},$e,i.createElement("div",{style:{position:"absolute",inset:0,pointerEvents:"none"}},Ne)))});_e.displayName="Input";function re(t,n){try{t.insertRule(n)}catch{console.error("input-otp could not insert CSS rule:",n)}}var kt=`
[data-input-otp] {
  --nojs-bg: white !important;
  --nojs-fg: black !important;

  background-color: var(--nojs-bg) !important;
  color: var(--nojs-fg) !important;
  caret-color: var(--nojs-fg) !important;
  letter-spacing: .25em !important;
  text-align: center !important;
  border: 1px solid var(--nojs-fg) !important;
  border-radius: 4px !important;
  width: 100% !important;
}
@media (prefers-color-scheme: dark) {
  [data-input-otp] {
    --nojs-bg: black !important;
    --nojs-fg: white !important;
  }
}`;function bt(t){return e.jsx(Et,{className:"tw-otp-input-container",children:e.jsx(_e,{maxLength:6,onChange:n=>{t.setValue(n)},onComplete:()=>{t.onEnter()},render:({slots:n})=>e.jsx(h,{center:"both",flex:"row",gap:"xs",children:n.map((a,o)=>e.jsx(Ct,{...a,isInvalid:t.isInvalid},o))}),value:t.value})})}const Et=xe({"& input":{maxWidth:"100%"}});function Ct(t){return e.jsxs(It,{"data-active":t.isActive,"data-error":t.isInvalid,children:[t.char!==null&&e.jsx("div",{children:t.char}),t.hasFakeCaret&&e.jsx(Lt,{})]})}const At=nt`
  0%, 100% {
    opacity: 0;
  },
  50% {
    opacity: 1;
  }
  `,Lt=xe(t=>({"&::before":{backgroundColor:fe().colors.primaryText,content:"''",display:"block",height:"1em",width:"1.5px"},alignItems:"center",animation:`${At} 1s infinite`,display:"flex",inset:0,justifyContent:"center",pointerEvents:"none",position:"absolute"})),It=xe(t=>{const n=fe();return{"&[data-active='true']":{borderColor:n.colors.accentText},"&[data-error='true']":{borderColor:n.colors.danger},alignItems:"center",border:`2px solid ${n.colors.borderColor}`,borderRadius:tt.lg,boxSizing:"border-box",color:n.colors.primaryText,display:"flex",fontSize:Oe.md,height:"40px",justifyContent:"center",padding:et.xs,position:"relative",textAlign:"center",transition:"color 200ms ease",width:"40px"}});function Ft(t){var ce;const{wallet:n,done:a,goBack:o,userInfo:r}=t,u=t.size==="wide",x=t.locale,[p,m]=i.useState(""),[S,d]=i.useState("idle"),[b,v]=i.useState(),[w,k]=i.useState("sending"),[y,f]=i.useState(0),j=te(n)?{id:n.id,partnerId:(ce=n.getConfig())==null?void 0:ce.partnerId}:void 0,[z]=i.useState("base"),F=i.useCallback(async()=>{m(""),d("idle"),k("sending");try{if("email"in r)await Me({client:t.client,ecosystem:j,email:r.email,strategy:"email"}),k("sent"),f(60);else if("phone"in r)await Me({client:t.client,ecosystem:j,phoneNumber:r.phone,strategy:"phone"}),k("sent"),f(60);else throw new Error("Invalid userInfo")}catch(c){console.error(c),d("idle"),k("error")}},[t.client,r,j]);async function $(c){if("email"in r)await n.connect({chain:t.chain,client:t.client,email:r.email,strategy:"email",verificationCode:c}),await X("email",ee);else if("phone"in r)await n.connect({chain:t.chain,client:t.client,phoneNumber:r.phone,strategy:"phone",verificationCode:c}),await X("phone",ee);else throw new Error("Invalid userInfo")}async function G(c){"email"in r?await Z({client:t.client,ecosystem:j,email:r.email,strategy:"email",verificationCode:c}):"phone"in r&&await Z({client:t.client,ecosystem:j,phoneNumber:r.phone,strategy:"phone",verificationCode:c})}const L=async c=>{var W;if(c.length===6){d("verifying");try{t.isLinking?await G(c):await $(c),a(),d("valid")}catch(I){I instanceof Error&&((W=I==null?void 0:I.message)!=null&&W.includes("PAYMENT_METHOD_REQUIRED"))?d("payment_required"):I instanceof Error&&(I.message.toLowerCase().includes("link")||I.message.toLowerCase().includes("profile"))?(d("linking_error"),v(I.message)):d("invalid"),console.error("Authentication Error",I)}}},B=i.useRef(!1);return i.useEffect(()=>{B.current||(B.current=!0,F())},[F]),i.useEffect(()=>{if(y<=0)return;const c=setInterval(()=>{f(W=>W<=1?(clearInterval(c),0):W-1)},1e3);return()=>clearInterval(c)},[y]),z==="base"?e.jsxs(h,{animate:"fadein",flex:"column",fullHeight:!0,className:"tw-otp-login-screen",children:[e.jsx(h,{p:"lg",children:e.jsx(se,{onBack:o,title:x.signIn})}),e.jsx(h,{center:"y",expand:!0,flex:"column",children:e.jsxs("form",{onSubmit:c=>{c.preventDefault()},children:[e.jsxs(h,{center:"x",flex:"column",px:"lg",children:[!u&&e.jsx(g,{y:"xl"}),e.jsx(A,{className:"tw-screen-title",children:x.emailLoginScreen.enterCodeSendTo}),e.jsx(g,{y:"sm"}),e.jsx(A,{color:"primaryText",children:"email"in r?r.email:r.phone}),e.jsx(g,{y:"xl"})]}),e.jsx(bt,{digits:6,isInvalid:S==="invalid",onEnter:()=>{L(p)},setValue:c=>{m(c),d("idle")},value:p}),S==="invalid"&&e.jsxs(ve,{children:[e.jsx(g,{y:"md"}),e.jsx(A,{center:!0,color:"danger",size:"sm",className:"tw-invalid-code-text",children:x.emailLoginScreen.invalidCode})]}),S==="linking_error"&&e.jsxs(ve,{children:[e.jsx(g,{y:"md"}),e.jsx(A,{center:!0,color:"danger",size:"sm",className:"tw-screen-error",children:b||"Failed to verify code"})]}),S==="payment_required"&&e.jsxs(ve,{children:[e.jsx(g,{y:"md"}),e.jsx(A,{center:!0,color:"danger",size:"sm",className:"tw-screen-error",children:x.maxAccountsExceeded})]}),e.jsx(g,{y:"xl"}),e.jsx(h,{px:u?"xxl":"lg",children:S==="verifying"?e.jsx(h,{animate:"fadein",center:"x",flex:"row",children:e.jsx(le,{color:"accentText",size:"lg"})}):e.jsx(h,{animate:"fadein",children:e.jsx(Y,{onClick:()=>L(p),style:{width:"100%"},type:"submit",variant:"accent",className:"tw-verify-button",children:x.emailLoginScreen.verify})},"btn-container")}),e.jsx(g,{y:"xl"}),!u&&e.jsx(it,{}),e.jsxs(h,{gap:"xs",p:u?void 0:"lg",children:[w==="error"&&e.jsx(A,{center:!0,color:"danger",size:"sm",className:"tw-screen-error",children:x.emailLoginScreen.failedToSendCode}),w==="sending"&&e.jsxs(h,{center:"both",flex:"row",gap:"xs",style:{textAlign:"center"},children:[e.jsx(A,{size:"sm",children:x.emailLoginScreen.sendingCode}),e.jsx(le,{color:"secondaryText",size:"xs"})]}),w!=="sending"&&e.jsx(Pt,{onClick:y===0?F:void 0,style:{cursor:y>0?"default":"pointer",opacity:y>0?.5:1},className:"tw-resend-button",type:"button",children:y>0?`Resend code in ${y} seconds`:x.emailLoginScreen.resendCode})]})]})})]}):null}const Pt=at(t=>{const n=fe();return{all:"unset","&:hover":{color:n.colors.primaryText},color:n.colors.accentText,cursor:"pointer",fontSize:Oe.sm,fontWeight:500,textAlign:"center",width:"100%"}});function _t(t){const{wallet:n,done:a,client:o,chain:r,size:u,locale:x}=t,[p,m]=i.useState("loading"),S=i.useRef(!1);return i.useEffect(()=>{S.current||(S.current=!0,st(o,te(n.id)?n.id:void 0).then(d=>{m(d?"login":"select")}).catch(()=>{m("select")}))},[o,n.id]),e.jsxs(h,{animate:"fadein",flex:"column",fullHeight:!0,children:[e.jsx(h,{p:"lg",children:e.jsx(se,{onBack:t.onBack,title:t.isLinking?x.passkeys.linkPasskey:x.passkeys.title})}),e.jsx(h,{center:"y",expand:!0,flex:"column",px:u==="wide"?"xxl":"lg",children:e.jsxs("div",{children:[p==="loading"&&e.jsxs(e.Fragment,{children:[e.jsx(Be,{}),e.jsx(g,{y:"xxl"})]}),p==="select"&&e.jsx(Mt,{onSignin:()=>{m("login")},onSignup:()=>{m("signup")}}),p==="login"&&e.jsx(Wt,{chain:r,client:o,done:a,isLinking:t.isLinking,onCreate:()=>{m("signup")},wallet:n}),p==="signup"&&e.jsx(Tt,{chain:r,client:o,done:a,isLinking:t.isLinking,wallet:n})]})})]})}function Wt(t){const{wallet:n,done:a,client:o,chain:r}=t,[u,x]=i.useState("loading"),[p,m]=i.useState();async function S(){x("loading");try{t.isLinking?await Z({client:o,strategy:"passkey",type:"sign-in"}).catch(b=>{throw m(b.message),b}):(await n.connect({chain:r,client:o,strategy:"passkey",type:"sign-in"}),await X("passkey",ee)),a()}catch(b){console.error("Failed to login with passkey",b),x("error")}}const d=i.useRef(!1);return i.useEffect(()=>{d.current||(d.current=!0,S())}),u==="loading"?e.jsx(ke,{icon:e.jsx(we,{size:oe.xxl}),subtitle:"A pop-up prompt will appear to sign-in and verify your passkey",title:"Requesting Passkey"}):u==="error"?e.jsxs(e.Fragment,{children:[e.jsx(Se,{onTryAgain:S,title:p||"Failed to Login"}),e.jsx(g,{y:"sm"}),e.jsx(Y,{fullWidth:!0,onClick:t.onCreate,variant:"outline",children:"Create a new Passkey"}),e.jsx(g,{y:"lg"})]}):null}function Tt(t){var v;const{wallet:n,done:a,client:o,chain:r}=t,[u,x]=i.useState(),[p,m]=i.useState("loading"),S=te(n)?{id:n.id,partnerId:(v=n.getConfig())==null?void 0:v.partnerId}:void 0;async function d(){m("loading");try{t.isLinking?await Z({client:o,ecosystem:S,strategy:"passkey",type:"sign-up"}):(await n.connect({chain:r,client:o,strategy:"passkey",type:"sign-up"}),await X("passkey",ee)),a()}catch(w){console.error(w),w instanceof Error&&x(`Error creating passkey: ${w.message}`),m("error")}}const b=i.useRef(!1);return i.useEffect(()=>{b.current||(b.current=!0,d())}),p==="loading"?e.jsx(ke,{icon:e.jsx(we,{size:oe.xxl}),subtitle:"A pop-up prompt will appear to sign-in and verify your passkey",title:"Creating Passkey"}):p==="error"?e.jsxs(e.Fragment,{children:[e.jsx(Se,{onTryAgain:d,title:u||"Failed to create passkey"}),e.jsx(g,{y:"lg"})]}):null}function Mt(t){return e.jsxs(h,{children:[e.jsx(g,{y:"xxl"}),e.jsx(h,{center:"x",color:"accentText",flex:"row",children:e.jsx(we,{size:oe["4xl"]})}),e.jsx(g,{y:"xl"}),e.jsx(g,{y:"xxl"}),e.jsx(Y,{fullWidth:!0,onClick:t.onSignup,variant:"accent",children:"Create a Passkey"}),e.jsx(g,{y:"sm"}),e.jsx(Y,{fullWidth:!0,onClick:t.onSignin,variant:"outline",children:"I have a Passkey"}),e.jsx(g,{y:"lg"})]})}function Ht(t){var k,y;const n=t.locale,a=n.socialLoginScreen,o=fe(),r=te(t.wallet)?{id:t.wallet.id,partnerId:(k=t.wallet.getConfig())==null?void 0:k.partnerId}:void 0,[u,x]=i.useState(void 0),{done:p,wallet:m}=t,[S,d]=i.useState("connecting"),b=async()=>{var z,F,$,G;const f=m.getConfig(),j=f&&"auth"in f?((z=f==null?void 0:f.auth)==null?void 0:z.mode)??"popup":"popup";if(f&&"auth"in f&&j!=="popup"&&!t.isLinking)return rt({authOption:t.socialAuth,client:t.client,ecosystem:r,mode:(F=f==null?void 0:f.auth)==null?void 0:F.mode,redirectUrl:($=f==null?void 0:f.auth)==null?void 0:$.redirectUrl});try{const L=lt({authOption:t.socialAuth,client:t.client,ecosystem:r,themeObj:o});if(!L)throw new Error(`Failed to open ${t.socialAuth} login window`);d("connecting"),t.isLinking?await Z({client:t.client,closeOpenedWindow:B=>{B.close()},ecosystem:r,openedWindow:L,strategy:t.socialAuth}).catch(B=>{throw x(B.message),B}):await m.connect({chain:t.chain,client:t.client,closeOpenedWindow:B=>{B.close()},openedWindow:L,strategy:t.socialAuth}),await X(t.socialAuth,ee),d("connected"),p()}catch(L){d("error"),L instanceof Error&&((G=L==null?void 0:L.message)!=null&&G.includes("PAYMENT_METHOD_REQUIRED"))&&x(n.maxAccountsExceeded),console.error(`Error signing in with ${t.socialAuth}`,L)}},v=(y=t.state)==null?void 0:y.socialLogin,w=i.useRef(!1);return i.useEffect(()=>{w.current||v&&(w.current=!0,d("connecting"),v.connectionPromise.then(()=>{p(),d("connected")}).catch(f=>{x(f.message),d("error")}))},[p,v]),e.jsx(h,{animate:"fadein",flex:"column",fullHeight:!0,className:"tw-social-login-screen",children:e.jsxs(h,{expand:!0,flex:"column",p:"lg",style:{paddingBottom:0},children:[t.goBack&&e.jsx(se,{onBack:t.goBack,title:t.isLinking?t.connectLocale.manageWallet.linkProfile:a.title}),t.size==="compact"?e.jsx(g,{y:"xl"}):null,e.jsxs(h,{center:"both",expand:!0,flex:"column",style:{minHeight:"250px",textAlign:"center"},children:[S!=="error"&&e.jsxs(h,{animate:"fadein",children:[e.jsx(A,{center:!0,color:"primaryText",multiline:!0,style:{maxWidth:"250px"},children:a.instruction}),e.jsx(g,{y:"xl"}),e.jsx(h,{center:"x",flex:"row",children:e.jsx(le,{color:"accentText",size:"lg"})}),e.jsx(g,{y:"xxl"})]}),S==="error"&&e.jsxs(h,{animate:"fadein",children:[u?e.jsx(A,{center:!0,color:"danger",children:u}):e.jsx(A,{color:"danger",children:a.failed}),e.jsx(g,{y:"lg"}),e.jsx(Y,{onClick:b,variant:"primary",children:a.retry}),e.jsx(g,{y:"xxl"})]})]})]})})}export{Dt as G,Ft as O,_t as P,Ht as S,zt as W};
